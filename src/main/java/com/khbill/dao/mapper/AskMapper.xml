<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.khbill.dao.face.AskDao">


<resultMap type="com.khbill.dto.Ask" id="Ask">
	<id column="ask_no" property="askNo" />
	<result column="user_no" property="userNo" />
	<result column="product_no" property="productNo" />
	<result column="ask_title" property="askTitle" />
	<result column="ask_content" property="askContent" />
	<result column="ask_date" property="askDate" />
	<result column="ask_hit" property="askHit" />
</resultMap>
	
<resultMap type="com.khbill.dto.User" id="User">
	<id column="user_no" property="userNo" />
	<result column="user_id" property="userId" />
	<result column="user_pw" property="userPw" />
	<result column="user_nick" property="userNick" />
	<result column="user_mail" property="userMail" />
	<result column="join_date" property="joinDate" />
	<result column="extra_money" property="extraMoney" />
	<result column="user_bday" property="userBday" />
	<result column="user_gender" property="userGender" />
	<result column="user_point" property="userPoint" />
</resultMap>

<sql id="selectAsk">
	SELECT ask_no,user_no,product_no,ask_title,ask_content,ask_date,ask_hit
	FROM zask
</sql>

<sql id="whereTitleSearch">
		WHERE ask_title LIKE '%' || #{search, jdbcType=VARCHAR} || '%'
</sql>

<select id="selectAskList" resultMap="Ask" parameterType="com.khbill.util.Paging">
	SELECT * FROM (
			SELECT rownum rnum, A.* FROM (
				<include refid="selectAsk"/>
				<include refid="whereTitleSearch"/>
				ORDER BY ask_no DESC
			) A
		) R
		WHERE rnum BETWEEN #{startNo} AND #{endNo}
</select>

<select id="selectCntAll" resultType="int" parameterType="com.khbill.util.Paging">
	SELECT COUNT(*) FROM (
			<include refid="selectAsk"/>
			<include refid="whereTitleSearch"/>
		)
</select>


<select id="selectUserInfo" resultMap="User" parameterType="int">
	SELECT * from zuser
	WHERE user_no = #{userNo}
</select>


<select id="selectUserList" resultMap="User">
	SELECT * from zuser
</select>






</mapper>
